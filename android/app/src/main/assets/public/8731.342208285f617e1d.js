"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8731],{8490:(_,v,c)=>{c.d(v,{u:()=>y});var u=c(467),r=c(2615),S=c(7291);let y=(()=>{var e;class o{constructor(d){this.storageService=d}getContacts(){var d=this;return(0,u.A)(function*(){return d.storageService.getContacts()})()}addContact(d){var h=this;return(0,u.A)(function*(){return h.storageService.addContact(d)})()}updateContact(d){var h=this;return(0,u.A)(function*(){return h.storageService.updateContact(d)})()}deleteContact(d){var h=this;return(0,u.A)(function*(){return h.storageService.deleteContact(d)})()}static#e=e=()=>(this.\u0275fac=function(h){return new(h||o)(r.KVO(S.n))},this.\u0275prov=r.jDH({token:o,factory:o.\u0275fac,providedIn:"root"}))}return e(),o})()},8731:(_,v,c)=>{c.r(v),c.d(v,{SettingsPage:()=>A});var u=c(467),r=c(9893),S=c(2200),y=c(4341),e=c(3664),o=c(2615),j=c(487),d=c(8490),h=c(7291);let T=(()=>{var g;class m{constructor(i,t){this.dataService=i,this.storageService=t}exportReminders(){var i=this;return(0,u.A)(function*(){const t=yield i.dataService.getContacts(),n=JSON.stringify(t,null,2),s=new Blob([n],{type:"application/json"}),l=window.URL.createObjectURL(s),a=document.createElement("a");a.href=l,a.download=`hellodays_backup_${(new Date).toISOString().slice(0,10)}.json`,document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(l)})()}importReminders(i){var t=this;return(0,u.A)(function*(){return new Promise(n=>{const s=new FileReader;s.onload=function(){var l=(0,u.A)(function*(a){try{const p=a.target?.result,f=JSON.parse(p);if(!Array.isArray(f)||f.length>0&&!f[0].firstName)throw new Error("Invalid backup file format.");yield t.storageService.saveContacts(f),n({success:!0,message:`${f.length} reminders imported successfully.`})}catch(p){n({success:!1,message:p.message||"Failed to parse backup file."})}});return function(a){return l.apply(this,arguments)}}(),s.onerror=()=>{n({success:!1,message:"Failed to read the file."})},s.readAsText(i)})})()}static#e=g=()=>(this.\u0275fac=function(t){return new(t||m)(o.KVO(d.u),o.KVO(h.n))},this.\u0275prov=o.jDH({token:m,factory:m.\u0275fac,providedIn:"root"}))}return g(),m})();var b=c(7650),k=c(875);const F=["fileInput"];function I(g,m){if(1&g){const C=e.RV6();e.j41(0,"ion-datetime",11),e.bIt("ionChange",function(t){o.eBV(C);const n=e.XpG();return o.Njj(n.onTimeChange(t))}),e.k0s()}if(2&g){const C=e.XpG();e.Y8G("value",C.displayTime)}}let A=(()=>{var g;class m{constructor(i,t,n,s,l,a,p){this.themeService=i,this.backupService=t,this.alertCtrl=n,this.toastCtrl=s,this.notificationService=l,this.dataService=a,this.settingsService=p,this.displayTime=(new Date).toISOString()}ngOnInit(){this.settingsSub=this.settingsService.settings$.subscribe(i=>{const[t,n]=i.defaultReminderTime.split(":"),s=new Date;s.setHours(Number(t),Number(n),0),this.displayTime=s.toISOString()})}onThemeChange(i){this.themeService.toggleTheme()}onTimeChange(i){const n=i.detail.value.split("T")[1].slice(0,8),l={...this.settingsService.getCurrentSettings(),defaultReminderTime:n};this.settingsService.saveSettings(l),this.presentToast("Default reminder time saved.")}exportData(){var i=this;return(0,u.A)(function*(){yield i.backupService.exportReminders(),i.presentToast("Reminders exported successfully.")})()}triggerImport(){this.fileInput.nativeElement.click()}importData(i){var t=this;return(0,u.A)(function*(){const n=i.target.files[0];var l;n&&(yield(yield t.alertCtrl.create({header:"Confirm Import",message:"This will overwrite all current reminders. Are you sure?",buttons:[{text:"Cancel",role:"cancel"},{text:"Import",handler:(l=(0,u.A)(function*(){const a=yield t.backupService.importReminders(n);a.success?(t.presentToast(a.message),yield t.rescheduleAllNotifications()):t.presentToast(`Error: ${a.message}`,"danger")}),function(){return l.apply(this,arguments)})}]})).present(),t.fileInput.nativeElement.value="")})()}rescheduleAllNotifications(){var i=this;return(0,u.A)(function*(){yield i.notificationService.cancelAll();const t=yield i.dataService.getContacts();for(const n of t)yield i.notificationService.scheduleReminders(n);console.log("All notifications have been rescheduled.")})()}presentToast(i){var t=this;return(0,u.A)(function*(n,s="primary"){(yield t.toastCtrl.create({message:n,duration:3e3,color:s,position:"bottom"})).present()}).apply(this,arguments)}ngOnDestroy(){this.settingsSub&&this.settingsSub.unsubscribe()}static#e=g=()=>(this.\u0275fac=function(t){return new(t||m)(e.rXU(j.F),e.rXU(T),e.rXU(r.hG),e.rXU(r.K_),e.rXU(b.J),e.rXU(d.u),e.rXU(k.h))},this.\u0275cmp=e.VBU({type:m,selectors:[["app-settings"]],viewQuery:function(t,n){if(1&t&&e.GBs(F,5),2&t){let s;e.mGM(s=e.lsd())&&(n.fileInput=s.first)}},decls:39,vars:6,consts:[["fileInput",""],["name","moon-outline","slot","start"],["slot","end",3,"ionChange","checked"],["button","true","id","open-time-picker"],["name","time-outline","slot","start"],["slot","end"],["trigger","open-time-picker",3,"keepContentsMounted"],["button","true","detail","true",3,"click"],["name","download-outline","slot","start"],["name","cloud-upload-outline","slot","start"],["type","file","accept","application/json",2,"display","none",3,"change"],["presentation","time",3,"ionChange","value"]],template:function(t,n){if(1&t){const s=e.RV6();e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e.EFF(3,"Settings"),e.k0s()()(),e.j41(4,"ion-content")(5,"ion-list")(6,"ion-list-header")(7,"ion-label"),e.EFF(8,"Appearance"),e.k0s()(),e.j41(9,"ion-item"),e.nrm(10,"ion-icon",1),e.j41(11,"ion-label"),e.EFF(12,"Dark Mode"),e.k0s(),e.j41(13,"ion-toggle",2),e.bIt("ionChange",function(a){return o.eBV(s),o.Njj(n.onThemeChange(a))}),e.k0s()(),e.j41(14,"ion-list-header")(15,"ion-label"),e.EFF(16,"Reminders"),e.k0s()(),e.j41(17,"ion-item",3),e.nrm(18,"ion-icon",4),e.j41(19,"ion-label"),e.EFF(20,"Default Time"),e.k0s(),e.j41(21,"ion-text",5),e.EFF(22),e.nI1(23,"date"),e.k0s()(),e.j41(24,"ion-popover",6),e.DNE(25,I,1,1,"ng-template"),e.k0s(),e.j41(26,"ion-list-header")(27,"ion-label"),e.EFF(28,"Data Management"),e.k0s()(),e.j41(29,"ion-item",7),e.bIt("click",function(){return o.eBV(s),o.Njj(n.exportData())}),e.nrm(30,"ion-icon",8),e.j41(31,"ion-label"),e.EFF(32,"Export Reminders"),e.k0s()(),e.j41(33,"ion-item",7),e.bIt("click",function(){return o.eBV(s),o.Njj(n.triggerImport())}),e.nrm(34,"ion-icon",9),e.j41(35,"ion-label"),e.EFF(36,"Import Reminders"),e.k0s()()(),e.j41(37,"input",10,0),e.bIt("change",function(a){return o.eBV(s),o.Njj(n.importData(a))}),e.k0s()()}2&t&&(e.R7$(13),e.Y8G("checked",n.themeService.isDarkMode),e.R7$(9),e.JRh(e.i5U(23,3,n.displayTime,"shortTime")),e.R7$(2),e.Y8G("keepContentsMounted",!0))},dependencies:[r.bv,r.W9,r.A9,r.eU,r.iq,r.uz,r.he,r.nf,r.AF,r.IO,r.BC,r.BY,r.ai,r.CF,r.hB,r.Je,S.MD,y.YN,S.vh],encapsulation:2}))}return g(),m})()}}]);